"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.createTestRunnerFactory = void 0;
const plugin_1 = require("@stryker-mutator/api/plugin");
const di_1 = require("../di");
const RetryDecorator_1 = require("./RetryDecorator");
const TimeoutDecorator_1 = require("./TimeoutDecorator");
const ChildProcessTestRunnerDecorator_1 = require("./ChildProcessTestRunnerDecorator");
const CommandTestRunner_1 = require("./CommandTestRunner");
const MaxTestRunnerReuseDecorator_1 = require("./MaxTestRunnerReuseDecorator");
createTestRunnerFactory.inject = plugin_1.tokens(plugin_1.commonTokens.options, di_1.coreTokens.sandbox, di_1.coreTokens.loggingContext);
function createTestRunnerFactory(options, sandbox, loggingContext) {
    if (CommandTestRunner_1.default.is(options.testRunner)) {
        return () => new RetryDecorator_1.default(() => new TimeoutDecorator_1.default(() => new CommandTestRunner_1.default(sandbox.workingDirectory, options)));
    }
    else {
        return () => new RetryDecorator_1.default(() => new MaxTestRunnerReuseDecorator_1.default(() => new TimeoutDecorator_1.default(() => new ChildProcessTestRunnerDecorator_1.default(options, sandbox.workingDirectory, loggingContext)), options));
    }
}
exports.createTestRunnerFactory = createTestRunnerFactory;
//# sourceMappingURL=index.js.map